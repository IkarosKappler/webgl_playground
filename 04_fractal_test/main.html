<!DOCTYPE html>
<html>
  <head>
    <title>WebGL Fractal Test</title>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Content Description" />
    <meta name="keywords" content="any, keywords, you, want" />
    <meta name="author" content="Ikaros Kappler" />
    <meta name="date" content="2020-04-20" />

    <!-- Load custom scripts --->
    <script src="initWebGL.js"></script>
    <script src="utils.js"></script>
    <script src="canvasFullpage.js"></script>
    <script src="main.js"></script>
    <link rel="stylesheet" type="text/css" media="screen" href="style.css" />

    <!-- Define vertex shader program -->
    <script id="shader-vs" type="x-shader/x-vertex">
      precision mediump float;

      attribute vec3 aPosition;

      uniform vec2 uRotationVector;

      void main(void) {
	vec2 rotatedPosition = vec2(
	    aPosition.x * uRotationVector.y +
		aPosition.y * uRotationVector.x,
	    aPosition.y * uRotationVector.y -
		aPosition.x * uRotationVector.x
	);

	gl_Position = vec4(rotatedPosition, aPosition.z, 1.0);
      }
    </script>
    
    <!-- Define fragment shader program -->
    <script id="shader-fs" type="x-shader/x-fragment">      
      precision highp float;

      uniform vec2 uC;
      uniform vec2 uCanvasSize;
      uniform int  uIterationCount;

      void main(void) {
         float R = (gl_FragCoord.x - uCanvasSize.x) / uCanvasSize.y;
         float I = (gl_FragCoord.y - uCanvasSize.x) / uCanvasSize.y;
         float R2 = R*R, I2 = I*I;
         int mm;
         for(int m = 0; m < 255; m++){
			    I=(R+R)*I + uC.y;
			    R=R2-I2 + uC.x;
			    R2=R*R;
			    I2=I*I;
			    mm = m;
			 if( R2 + I2 > 4. ) break;
         }
         if (mm == 254) gl_FragColor = vec4(0., 0., 0., 1.);
         else{
	   float a = float(mm);  a = mod(a, 30.) / 10.;
	   gl_FragColor = vec4( max(0., abs(a - 1.5) - .5),
	   max(0., 1. - abs(a - 1.)), max(0., 1. - abs(a - 2.)), 1.);
	 }
       }
    </script>
  </head>

  <body>
    <canvas id="canvas" width="640" height="480" style="width: 640px; height: 480px;">
      Your browser does not support WebGL.
    </canvas>
  </body>
</html>
